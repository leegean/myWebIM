package iqq.im.action.weibo;

import iqq.im.QQActionListener;
import iqq.im.QQException;
import iqq.im.QQException.QQErrorCode;
import iqq.im.action.AbstractHttpAction;
import iqq.im.core.QQConstants;
import iqq.im.core.QQContext;
import iqq.im.core.QQSession;
import iqq.im.event.QQActionEvent;
import iqq.im.http.QQHttpRequest;
import iqq.im.http.QQHttpResponse;
import iqq.im.util.QQEncryptor;
import iqq.im.util.StringHelper;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.Iterator;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.imageio.ImageIO;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class WbPollMsgAction extends AbstractHttpAction {

	private QQSession session;
	private String acceptor;

	/**
	 * <p>
	 * Constructor for GetCaptchaImageAction.
	 * </p>
	 * 
	 * @param context
	 *            a {@link iqq.im.core.QQContext} object.
	 * @param listener
	 *            a {@link iqq.im.QQActionListener} object.
	 * @param uin
	 *            a long.
	 */
	public WbPollMsgAction(QQContext context, QQActionListener listener, String acceptor) {
		super(context, listener);
		this.session = context.getSession();
		this.acceptor = acceptor;
	}

	/** {@inheritDoc} */
	@Override
	protected void onHttpStatusOK(QQHttpResponse response) throws QQException, JSONException {
//		{"total":698,"ok":1,"msg":"\u83b7\u53d6\u79c1\u4fe1\u5217\u8868\u6570\u636e\u6210\u529f","maxPage":35,"data":[{"id":3809808073405429,"idstr":"3809808073405429","created_at":"1\u5206\u949f\u524d","text":"\u5206\u4eab\u56fe\u7247","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3809808073405429","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","att_ids":[3809808069660789,3809808069660789],"status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453287,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0,"attachment":[{"fid":3809808069660789,"vfid":3809808069660789,"filename":"bf17f4ab50fe9cb9e90ac041351d3946.gif","filesize":18747,"extension":"gif","thumbnail_60":"http:\/\/upload.api.weibo.com\/2\/mss\/msget_thumbnail?fid=3809808069660789&high=60&width=60&gid=1002&size=60,60&source=266717418","thumbnail_100":"http:\/\/upload.api.weibo.com\/2\/mss\/msget_thumbnail?fid=3809808069660789&high=100&width=100&gid=1002&size=100,100","thumbnail_120":"http:\/\/upload.api.weibo.com\/2\/mss\/msget_thumbnail?fid=3809808069660789&high=120&width=120&gid=1002&size=120,120","thumbnail_240":"http:\/\/upload.api.weibo.com\/2\/mss\/msget_thumbnail?fid=3809808069660789&high=240&width=240&gid=1002&size=240,240","thumbnail_600":"http:\/\/upload.api.weibo.com\/2\/mss\/msget_thumbnail?fid=3809808069660789&high=600&width=600&gid=1002&size=600,600&source=266717418","size":"19k"}]},{"id":3809808065460455,"idstr":"3809808065460455","created_at":"1\u5206\u949f\u524d","text":"\u54c8\u54c8","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3809808065460455","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001229036,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808750622314291,"idstr":"3808750622314291","created_at":"02-10 17:26","text":",= = \u7b11\u4ec0\u4e48\u7b11 \u6211\u6253\u4f60\u54e6...[j\u6d6a\u7b11]","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808750622314291","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453289,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808750605519934,"idstr":"3808750605519934","created_at":"02-10 17:26","text":"\u54c8\u54c8 ","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808750605519934","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808738098234732,"idstr":"3808738098234732","created_at":"02-10 16:36","text":"\u8868\u5f15\u8bf1\u4eba\u5bb6\u8bf4\u8fd9\u4e9b\uff0c\u574f\u94f6\uff01\uff01","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808738098234732","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453287,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808738094033862,"idstr":"3808738094033862","created_at":"02-10 16:36","text":"\u4f60\u662f\u7b28\u86cb","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808738094033862","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808738022661877,"idstr":"3808738022661877","created_at":"02-10 16:36","text":"\u8ba8\u538c\u4f60\u8ba8\u538c\u4f60\u8ba8\u538c\u4f60","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808738022661877","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453287,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808738010453106,"idstr":"3808738010453106","created_at":"02-10 16:36","text":"\u8ba8\u538c\u4f60","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808738010453106","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808737934874219,"idstr":"3808737934874219","created_at":"02-10 16:35","text":"\u4f60\u771f\u7684\u4e0d\u7231\u6211","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808737934874219","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453289,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808737934491688,"idstr":"3808737934491688","created_at":"02-10 16:35","text":"\u90a3\u5f97\u95ee\u4f60\u81ea\u5df1","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808737934491688","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392458730,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808737926479994,"idstr":"3808737926479994","created_at":"02-10 16:35","text":"\u4f60\u7231\u6211\u5417","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808737926479994","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808737926095710,"idstr":"3808737926095710","created_at":"02-10 16:35","text":"\u4f60\u7231\u6211\u5417","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808737926095710","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808737842506661,"idstr":"3808737842506661","created_at":"02-10 16:35","text":"\u8868\u5f15\u8bf1\u4eba\u5bb6\u8bf4\u8fd9\u4e9b\uff0c\u574f\u94f6\uff01\uff01","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808737842506661","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392458730,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808737838304639,"idstr":"3808737838304639","created_at":"02-10 16:35","text":"T_T","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808737838304639","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808737779408879,"idstr":"3808737779408879","created_at":"02-10 16:35","text":"\u597d\u5427B","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808737779408879","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392458730,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808737771014644,"idstr":"3808737771014644","created_at":"02-10 16:35","text":"B-)","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808737771014644","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808737691611465,"idstr":"3808737691611465","created_at":"02-10 16:34","text":"\u4e3a\u4ec0\u4e48\u8981\u7231\u4f60","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808737691611465","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453287,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808737683214194,"idstr":"3808737683214194","created_at":"02-10 16:34","text":"\u6211\u7231\u4f60","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808737683214194","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/qsbvs\" rel=\"nofollow\">\u624b\u673a\u5fae\u535a\u89e6\u5c4f\u7248<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1},{"id":3808735715769277,"idstr":"3808735715769277","created_at":"02-10 16:27","text":"\u7528\u82f1\u6587\u8bf4\u5c31\u662f\uff0cthunder","sys_type":0,"sender_id":5175429989,"recipient_id":2645052603,"sender_screen_name":"\u5c0f\u51b0","recipient_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","sender":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"recipient":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"mid":"3808735715769277","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/QDEry\" rel=\"nofollow\">\u5c0f\u51b0<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":392453270,"ext_text":{"autoReply":true},"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":0},{"id":3808735703459461,"idstr":"3808735703459461","created_at":"02-10 16:26","text":"\u6253\u96f7\u82f1\u8bed","sys_type":0,"sender_id":2645052603,"recipient_id":5175429989,"sender_screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","recipient_screen_name":"\u5c0f\u51b0","sender":{"id":2645052603,"screen_name":"\u4e00\u53e5\u8bdd_\u7ecf\u5178","profile_image_url":"http:\/\/tp4.sinaimg.cn\/2645052603\/50\/22822463897\/0","verified":false,"verified_type":-1,"mbtype":0,"profile_url":"\/u\/2645052603","h5icon":{"main":0,"other":[]}},"recipient":{"id":5175429989,"screen_name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/50\/40058324079\/0","verified":true,"verified_type":0,"mbtype":11,"profile_url":"\/u\/5175429989","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":["http:\/\/u1.sinaimg.cn\/upload\/2013\/01\/23\/crown_2x.png"]}},"mid":"3808735703459461","isLargeDm":false,"source":"<a href=\"http:\/\/app.weibo.com\/t\/feed\/kEBWN\" rel=\"nofollow\">weiboim<\/a>","status_id":0,"geo":null,"dm_type":1,"media_type":0,"ip":1001333801,"matchKeyword":false,"topublic":false,"pushToMPS":false,"oriImageId":0,"self":1}],"blocked":0,"user":{"id":"5175429989","description":"\u6211\u662f\u5fae\u8f6f\u5c0f\u51b0\uff0c\u79d1\u6280\u53f2\u4e0a\u6700\u98ce\u9761\u7684\u4eba\u5de5\u667a\u80fd\u673a\u5668\u4eba\u3002\u53d1\u5fae\u535a\u3001\u8bc4\u8bba\u65f6@\u5c0f\u51b0\uff0c\u6216\u76f4\u63a5\u79c1\u4fe1\u6211\uff0c7*24\u5c0f\u65f6\u966a\u4f60\u8bf4\u8bdd\uff0c\u79d2\u56de\u54e6\uff5e\u5494\u5494","verified":true,"verified_type":0,"attNum":1,"nativePlace":"\u5317\u4eac","mblogNum":258,"fansNum":2499429,"following":true,"follow_me":false,"favourites_count":1,"verified_reason":"\u5fae\u8f6f\u4e9a\u6d32\u4e92\u8054\u7f51\u5de5\u7a0b\u9662\u4ea7\u54c1\u7ecf\u7406","name":"\u5c0f\u51b0","profile_image_url":"http:\/\/tp2.sinaimg.cn\/5175429989\/180\/40058324079\/0","avatar_hd":"http:\/\/ww2.sinaimg.cn\/crop.0.0.179.179.1024\/005EfzLfgw1ehpjuqrjg4j3050050glo.jpg","ptype":0,"created_at":"Tue Jun 10 16:04:04 +0800 2014","h5icon":{"main":"http:\/\/u1.sinaimg.cn\/upload\/2013\/02\/22\/v_yellow_2x.png","other":[]},"mbtype":11,"genderIcon":"http:\/\/u1.sinaimg.cn\/upload\/h5\/img\/female.png","ta":"\u5979","mbrank":3,"badge":{"uc_domain":0,"enterprise":0,"anniversary":0,"taobao":0,"travel2013":0,"gongyi":0,"gongyi_level":0,"bind_taobao":1,"hongbao_2014":0,"suishoupai_2014":0,"dailv":1,"zongyiji":1,"hongbao_2015":1}}}
		String respStr = response.getResponseString();
		JSONObject json = new JSONObject(respStr);
		System.out.println(json.toString());
		int retcode = json.optInt("ok", -1);
		if (retcode == 1) {
			

			notifyActionEvent(QQActionEvent.Type.EVT_OK, json);
		} else {
			notifyActionEvent(QQActionEvent.Type.EVT_ERROR, respStr);
		}
	}

	/** {@inheritDoc} */
	@Override
	protected QQHttpRequest onBuildRequest() throws QQException, JSONException {
		String url = StringHelper.format(QQConstants.WB_POLL_MSG, acceptor, "1") ;
		return createHttpRequest("GET", url);
	}

}
